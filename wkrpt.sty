% Packages

\usepackage{chngcntr}
\usepackage{tgtermes}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{tocloft}
\usepackage{url}
\usepackage{scrextend}

% Typography

\onehalfspacing
\pagenumbering{roman}
\addtolength{\parskip}{\baselineskip}
\setlength{\parindent}{12pt}
\setlength{\parskip}{1em}

% Format

\titleformat*{\section}{\fontsize{16}{18}\bfseries}
\titleformat*{\subsection}{\fontsize{14}{16}\bfseries}
\titleformat*{\subsubsection}{\fontsize{12}{14}\bfseries}
\counterwithin{figure}{section}
\counterwithin{table}{section}
\bibliographystyle{IEEEtran}

% Information

\newcommand*{\thetitle}{\makeatletter\@title\makeatother}
\newcommand*{\theauthor}{\makeatletter\@author\makeatother}
\newcommand*{\thedate}{\makeatletter\@date\makeatother}

\newcommand*{\studentid}[1]{\newcommand*{\thestudentid}{#1}}
\newcommand*{\userid}[1]{\newcommand*{\theuserid}{#1}}
\newcommand*{\workterm}[1]{\newcommand*{\theworkterm}{#1}}
\newcommand*{\company}[1]{\newcommand*{\thecompany}{#1}}
\newcommand*{\companydepartment}[1]{\newcommand*{\thecompanydepartment}{#1}}
\newcommand*{\companylocation}[1]{\newcommand*{\thecompanylocation}{#1}}
\newcommand*{\addresslineone}[1]{\newcommand*{\theaddresslineone}{#1}}
\newcommand*{\addresslinetwo}[1]{\newcommand*{\theaddresslinetwo}{#1}}

% Title page

\renewcommand*{\titlepage}[1] {
	\begin{singlespace}
	\begin{center}
	{\bf \MakeUppercase{University of Waterloo}}\\
	{\bf Software Engineering}

	\vfill

	{\large\textsc{\bf\thetitle}}

	\vfill

	#1\\
	\thecompany\\
	\thecompanylocation

	\vfill

	{\bf Prepared by}\\
	\vspace{0.5\baselineskip}
	\theauthor\\
	Student ID: \thestudentid\\
	User ID: \theuserid\\
	\theworkterm{} Software Engineering\\
	\thedate

	\end{center}
	\end{singlespace}

	\vspace{0.75in}

	\thispagestyle{empty}
	\newpage
}

% Cover letter

\newcommand{\letter}[1] {
	\begin{singlespace}
	\setlength{\parindent}{0pt}

	\begin{addmargin}[4in]{0in}
	\theauthor\\
	\theaddresslineone\\
	\theaddresslinetwo

	\today
	\end{addmargin}

	\noindent
	Andrew Morton, Director\\
	Software Engineering\\
	University of Waterloo\\
	200 University Ave West\\
	Waterloo, ON, N2L 3G1

	\vfill

    Dear Sir:

	This report, entitled ``\thetitle{},'' was prepared during my \theworkterm{} work term at \thecompany{}, where I worked in the \thecompanydepartment{} department.

	#1

	I hereby confirm that I have received no help, other than what is mentioned above, in writing this report. I also confirm this report has not been previously submitted for academic credit at this or any other academic institution.

	\vfill

	\noindent
	Sincerely,\\

	\vfill

	\noindent
	\line(1,0){150}\\
	\theauthor\\
	Student ID: \thestudentid
	\end{singlespace}

	\thispagestyle{empty}
	\newpage
}

% Contents, figures, tables

\renewcommand*{\cftsecleader}{\bfseries\cftdotfill{\cftdotsep}}
\renewcommand*{\cftfigpresnum}{Figure }
\renewcommand*{\cftfignumwidth}{55pt}
\renewcommand*{\cftfigaftersnum}{: }
\renewcommand*{\cfttabpresnum}{Table }
\renewcommand*{\cfttabnumwidth}{50pt}
\renewcommand*{\cfttabaftersnum}{: }

\renewcommand*{\contentsname}{\begin{center}Table of Contents\end{center}}
\newcommand*{\toc} {
	\tableofcontents
	\addcontentsline{toc}{section}{Table of Contents}
	\newpage
}

\renewcommand*{\listfigurename}{\begin{center}List of Figures\end{center}}
\newcommand*{\lof} {
	\listoffigures
	\addcontentsline{toc}{section}{List of Figures}
	\newpage
}

\renewcommand*{\listtablename}{\begin{center}List of Tables\end{center}}
\newcommand*{\lot} {
	\listoftables
	\addcontentsline{toc}{section}{List of Tables}
	\newpage
}

% Other sections

\newcommand*{\tocsection}[1]{ 
	\section*{#1}
	\addcontentsline{toc}{section}{#1}
}

\renewcommand*{\refname}{References}
\newcommand*{\references}{
    \addcontentsline{toc}{section}{\refname}
    \bibliography{wkrpt}
    \newpage
}

\renewcommand*{\appendix}[2]{
    \tocsection{Appendix #1 -- #2}
    \renewcommand{\thesection}{#1}
}
